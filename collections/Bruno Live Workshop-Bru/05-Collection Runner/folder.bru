meta {
  name: 05-Collection Runner
  seq: 5
}

docs {
  # ğŸƒ Section 5: Collection Runner

  The Collection Runner lets you execute multiple requests in sequence â€” and with **data files**, you can run the same request multiple times with different data!

  In this section, you will:

  - âœ… Create requests that use data file variables
  - âœ… Run a folder using the Collection Runner
  - âœ… Use CSV data files for data-driven testing
  - âœ… Learn about the Bruno CLI for automation

  ---

  ### ğŸ‘¤ Step 1: Create "Create User"

  1. Right-click on the `05-Collection Runner` folder â†’ **New Request**
  2. Name it `Create User`
  3. Set the method to **POST**
  4. Set the URL to: `{{echoUrl}}`
  5. Go to **Body** â†’ **JSON** and paste:

  ```json
  {
    "name": "{{name}}",
    "job": "{{job}}"
  }
  ```

  6. Go to the **Assert** tab and add:

  | Expr | Operator | Value |
  |------|----------|-------|
  | res.status | equals | 200 |
  | res.body.name | isString | |
  | res.body.job | isString | |

  7. Go to the **Tests** tab and paste:

  ```javascript
  const body = res.getBody();

  test("User data was echoed back", () => {
    expect(body).to.have.property("name");
    expect(body).to.have.property("job");
  });

  test("Name is not empty", () => {
    expect(body.name.length).to.be.greaterThan(0);
  });
  ```

  ğŸ’¡ `{{name}}` and `{{job}}` are placeholders â€” they'll be filled by the data file when you use the Collection Runner!

  ---

  ### âœ”ï¸ Step 2: Create "Verify Creation"

  1. Create a new request named `Verify Creation`
  2. Set the method to **GET**
  3. Set the URL to: `{{baseUrl}}/users/1`
  4. Go to the **Assert** tab and add:

  | Expr | Operator | Value |
  |------|----------|-------|
  | res.status | equals | 200 |
  | res.body | isJson | |
  | res.body.id | equals | 1 |

  5. Go to the **Tests** tab and paste:

  ```javascript
  test("User exists and has valid data", () => {
    const body = res.getBody();
    expect(body).to.have.property("id");
    expect(body).to.have.property("name");
    expect(body).to.have.property("email");
  });

  test("Response time is acceptable", () => {
    expect(res.responseTime).to.be.below(5000);
  });
  ```

  ---

  ### ğŸƒ Step 3: Run the Collection Runner

  **Without a data file:**
  1. Right-click on the `05-Collection Runner` folder â†’ **Run**
  2. Watch both requests execute in sequence
  3. Review the test results

  **With a data file (the fun part!):**
  1. Right-click on the `05-Collection Runner` folder â†’ **Run**
  2. In the runner dialog, select the data file: `data-files/new-users.csv`
  3. Each row in the CSV becomes a separate run â€” `{{name}}` and `{{job}}` get replaced with row values
  4. Watch 5 users get created, one per CSV row! ğŸ‰

  ### ğŸ“ Data Files
  Check the `data-files/` folder at the collection root:
  - `new-users.csv` â€” CSV format (name, job columns)
  - `new-users.json` â€” JSON format (same data, array of objects)

  ---

  ### ğŸ’» Bruno CLI

  Everything in the GUI can also run from the terminal â€” great for CI/CD!

  ```bash
  # Run this folder
  bru run "05-Collection Runner" --env Workshop

  # Run with CSV data file
  bru run "05-Collection Runner" --env Workshop --csv-file-path data-files/new-users.csv

  # Run with JSON data file
  bru run "05-Collection Runner" --env Workshop --json-file-path data-files/new-users.json

  # Generate reports
  bru run "05-Collection Runner" --env Workshop --csv-file-path data-files/new-users.csv --reporter-html reports/report.html

  # Run entire collection
  bru run --env Workshop

  # Stop on first failure
  bru run --env Workshop --bail
  ```

  ---

  ### ğŸ“Œ Summary

  In this section, you learned how to:

  - âœ… Create requests with data file placeholders (`{{name}}`, `{{job}}`)
  - âœ… Use the Collection Runner to execute requests in sequence
  - âœ… Use CSV/JSON data files for data-driven testing
  - âœ… Use the Bruno CLI for headless/CI execution

  ğŸ“ Check the **Solution** folder to see the completed requests.
}
